{% extends 'base.html' %}
{% load static %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/posts/post-detail.css' %}" />
{% endblock %}

{% block content %}
<section class="post-container">
  <div class="post-img"></div>
  <div class="post-details">
    <h1>{{ post.title }}</h1>

    <p class="meta">
      By <a href="{% url 'profile_detail' post.user.id %}">{{ post.user.username }}</a> |
      Posted on {{ post.created_at|date:"F j, Y" }}
    </p>

    <div class="post-body">
      <p>{{ post.body }}</p>
    </div>

    {% if post.tags %}
      <p class="post-tags"><strong>Tags:</strong> {{ post.tags }}</p>
    {% endif %}

    {% if request.user == post.user %}
      <div class="post-actions">
        <a href="{% url 'post_edit' post.id %}" class="action-link">Edit</a>
        <a href="{% url 'post_delete' post.id %}" class="action-link danger-link">Delete</a>
      </div>
    {% endif %}
  </div>
</section>

<section class="comments-section">
  <h2>Comments</h2>

  <ul class="comment-list">
    {% for comment in comments %}
      <li class="comment">
        <div class="comment-header">
          <p><strong>{{ comment.user.username }}</strong> said:</p>
          <p>{{ comment.body }}</p>
        </div>

        <div class="comment-footer">
          <small>{{ comment.created_at|date:"F j, Y, g:i a" }}</small>

          {% if user.is_authenticated %}
            <a href="#" class="action-link reply-link" data-comment-id="{{ comment.id }}">Reply</a>
          {% endif %}
        </div>
      </li>
    {% empty %}
      <li class="no-comments">No comments yet. Be the first to comment!</li>
    {% endfor %}

  </ul>

  {% if user.is_authenticated %}
    <h3>Leave a comment</h3>
    <form method="POST" class="comment-form">
      {% csrf_token %}
      {{ form.as_p }}
      <button type="submit" class="action-link">Post Comment</button>
    </form>
  {% else %}
    <p><a href="{% url 'login' %}">Log in</a> to leave a comment.</p>
  {% endif %}
</section>



{% endblock %}